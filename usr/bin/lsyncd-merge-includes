#!/bin/bash
# Merge all include files into one temporary file for lsyncd/rsync.

MERGED="/run/lsyncd.merged-includes"
: > "$MERGED"   # truncate

for f in /etc/lsyncd/includes/*; do
    [ -r "$f" ] && cat "$f" | grep -Ev "^\s*(#)" >> "$MERGED"
done

# Always ensure we end with "exclude all"
echo "- *" >> "$MERGED"

echo "$MERGED"